databases:
  - name: rahman-postgres
    databaseName: restaurant_db
    user: rahman_user

services:
  - type: web
    name: rahman-restaurant
    env: node
    rootDir: backend
    autoDeploy: true
    healthCheckPath: /api/health
    buildCommand: npm install --omit=dev
    startCommand: npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: DATABASE_URL
        fromDatabase:
          name: rahman-postgres
          property: connectionString
      - key: PGSSL
        value: true
      - key: PGSSL_REJECT_UNAUTHORIZED
        value: false
      - key: JWT_SECRET
        generateValue: true
      - key: JWT_EXPIRES_IN
        value: 1h
      - key: TRUST_PROXY
        value: 1
      - key: API_RATE_LIMIT_WINDOW_MS
        value: 900000
      - key: API_RATE_LIMIT_MAX
        value: 200
      - key: CORS_ORIGIN
        value: https://rahmanrestaurant.netlify.app,https://rahman-restaurant.onrender.com
      - key: RESERVATION_WHATSAPP_NUMBER
        value: +917858062571
      - key: WHATSAPP_PROVIDER
        value: none
      - key: WHATSAPP_DEFAULT_COUNTRY_CODE
        value: 91
      - key: OPENAI_MODEL
        value: gpt-4o-mini
